import{_ as H,u as O,r as b,o as P,a as S,b as g,d as m,e as I,f as e,n as w,g as k,F as J,l as R,t as l,j as B,s as z,p as q,h as y,w as _,v as F,x as G,y as K,k as Q}from"./index-85c8a86e.js";const W={name:"Login",setup(){const u=O(),t=b(!1),c=b(""),r=b(!1),f=b(null),n=b({email:"",password:"",rememberMe:!1}),v={admin:{name:"مدير النظام",description:"صلاحيات كاملة على النظام والمحتوى",icon:"admin_panel_settings",color:"from-[#1B3C53] to-[#234C6A]"},user:{name:"مستفيد",description:"تصفح المحتوى والتفاعل مع القصص",icon:"person",color:"from-green-500 to-emerald-600"},employee:{name:"موظف",description:"إدارة المحتوى والمستخدمين والتقارير",icon:"engineering",color:"from-purple-500 to-indigo-600"}},x=[{type:"admin",name:"مدير النظام",email:"admin@example.com",password:"password123"},{type:"user",name:"مستفيد",email:"user@example.com",password:"password123"},{type:"employee",name:"موظف",email:"employee@example.com",password:"password123"}],s=o=>v[o]||v.user,T=o=>{const a=s(o);return{background:`linear-gradient(135deg, ${a.color.split(" ")[1]}, ${a.color.split(" ")[3]})`}},A=o=>{f.value=o,h()},E=o=>{const a=x.find(d=>d.type===o);a&&(n.value.email=a.email,n.value.password=a.password,h())},h=()=>{c.value=""},D=()=>{const o=JSON.parse(localStorage.getItem("libraryUsers")||"[]");x.forEach(a=>{o.find(i=>i.email===a.email)||o.push({id:Date.now()+Math.random(),fullName:a.name,email:a.email,password:a.password,accountType:a.type,phone:"+966500000000",status:"active",createdAt:new Date().toISOString(),lastLogin:null,avatar:a.name.charAt(0)})}),localStorage.setItem("libraryUsers",JSON.stringify(o))},N=()=>{try{const o=localStorage.getItem("libraryUsers");return o?JSON.parse(o):[]}catch(o){return console.error("❌ خطأ في تحميل بيانات المستخدمين:",o),[]}},M=(o,a)=>{const i=N().find(p=>p.email===o&&p.status==="active");return!i||i.password!==a?null:i},C=o=>({admin:"/admin",employee:"/employee/stories",user:"/favorites"})[o]||"/favorites",L=()=>{const o=localStorage.getItem("redirectAfterLogin");return o?(localStorage.removeItem("redirectAfterLogin"),o):null},U=()=>{const o=new StorageEvent("storage",{key:"authToken",newValue:localStorage.getItem("authToken"),oldValue:null,url:window.location.href,storageArea:localStorage});window.dispatchEvent(o),window.opener&&window.opener.postMessage({type:"AUTH_CHANGE",authenticated:!0},"*"),window.postMessage({type:"AUTH_CHANGE",authenticated:!0},"*");const a=localStorage.getItem("authToken");localStorage.setItem("authToken",a)},j=async()=>{if(!f.value){c.value="يرجى اختيار نوع الحساب أولاً";return}t.value=!0,c.value="";try{if(await new Promise(a=>setTimeout(a,1500)),!n.value.email||!n.value.password){c.value="يرجى إدخال البريد الإلكتروني وكلمة المرور";return}const o=M(n.value.email,n.value.password);if(o){const a={id:o.id,name:o.fullName,email:o.email,role:o.accountType,avatar:o.avatar,isAdmin:["admin","employee"].includes(o.accountType),type:o.accountType,phone:o.phone||""},d=`user-token-${Date.now()}`;localStorage.setItem("authToken",d),localStorage.setItem("userData",JSON.stringify(a)),localStorage.setItem("userType",o.accountType),n.value.rememberMe?localStorage.setItem("rememberedEmail",n.value.email):localStorage.removeItem("rememberedEmail"),localStorage.setItem("lastActivity",new Date().getTime().toString()),console.log("✅ تم تسجيل الدخول بنجاح:",a),U();const i=L();if(i)u.replace(i);else{const p=C(o.accountType);u.push(p)}}else c.value="البريد الإلكتروني أو كلمة المرور غير صحيحة"}catch(o){c.value="حدث خطأ أثناء تسجيل الدخول. حاول مرة أخرى.",console.error("❌ Login error:",o)}finally{t.value=!1}},V=()=>{const o=localStorage.getItem("rememberedEmail");o&&(n.value.email=o,n.value.rememberMe=!0)};return P(()=>{D(),V();const o=localStorage.getItem("authToken"),a=localStorage.getItem("userData");if(o&&a)try{const d=JSON.parse(a),i=L();if(i)u.replace(i);else{const p=C(d.accountType||d.type);u.push(p)}}catch{localStorage.removeItem("authToken"),localStorage.removeItem("userData"),localStorage.removeItem("userType")}}),{form:n,loading:t,error:c,showPassword:r,selectedLoginType:f,demoAccounts:x,selectLoginType:A,fillCredentials:E,performLogin:j,getLoginTypeInfo:s,getLoginTypeStyle:T,clearError:h}}},X={dir:"rtl",class:"min-h-screen bg-gradient-to-br from-blue-50 to-emerald-50 dark:from-gray-900 dark:to-gray-800 py-8"},Y={class:"container mx-auto px-4 py-8 max-w-4xl"},Z={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},$={class:"lg:col-span-1"},ee={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-200 dark:border-gray-700 p-6"},te={class:"space-y-4"},re={class:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-600"},oe={class:"space-y-3"},ae=["onClick"],se={class:"flex items-center justify-between"},ne={class:"text-xs font-medium text-gray-800 dark:text-white"},le={class:"text-xs text-gray-600 dark:text-gray-400"},ie={class:"lg:col-span-2"},de={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden"},ce={class:"bg-gradient-to-r from-[#1B3C53] to-[#234C6A] p-6 text-white"},ge={class:"flex items-center justify-between"},me={class:"flex items-center gap-3"},pe={class:"text-blue-100 text-sm"},ye={key:0,class:"flex items-center gap-2 bg-white/20 rounded-xl px-3 py-1"},ue={class:"material-icons text-sm"},xe={class:"font-medium text-sm"},be={class:"p-6"},fe={key:0,class:"text-center py-12"},ve={key:1,class:"space-y-6"},he={class:"bg-blue-50 dark:bg-blue-900/20 rounded-xl p-4"},we={class:"flex items-center gap-3"},ke={class:"material-icons text-sm"},_e={class:"font-bold text-gray-800 dark:text-white"},Te={class:"text-xs text-gray-600 dark:text-gray-400"},Ce={class:"group"},Le={class:"group"},Se={class:"relative"},Ie=["type"],Be={class:"material-icons"},Ae={class:"flex items-center justify-between"},Ee={class:"flex items-center gap-2"},De={key:0,class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4"},Ne={class:"flex items-center gap-3"},Me={class:"text-sm font-medium text-red-800 dark:text-red-200"},Ue=["disabled"],je={class:"material-icons"},Ve={class:"border-t border-gray-200 dark:border-gray-600 pt-6"},He={class:"text-center pt-4 border-t border-gray-200 dark:border-gray-600"},Oe={class:"text-sm text-gray-600 dark:text-gray-400"};function Pe(u,t,c,r,f,n){const v=S("AppHeader"),x=S("router-link");return g(),m("div",X,[I(v),e("main",Y,[t[28]||(t[28]=e("div",{class:"text-center mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-800 dark:text-white mb-3"}," تسجيل الدخول إلى المكتبة "),e("p",{class:"text-lg text-gray-600 dark:text-gray-300"}," اختر نوع الحساب وأدخل بيانات الدخول ")],-1)),e("div",Z,[e("div",$,[e("div",ee,[t[16]||(t[16]=e("h3",{class:"text-lg font-bold text-gray-800 dark:text-white mb-4"},"أنواع الحسابات",-1)),e("div",te,[e("div",{class:w(["flex items-center gap-3 p-4 border border-gray-200 dark:border-gray-600 rounded-xl hover:border-[#1B3C53] dark:hover:border-blue-600 transition-all duration-200 cursor-pointer",{"border-[#1B3C53] dark:border-blue-600 bg-blue-50 dark:bg-blue-900/20":r.selectedLoginType==="admin"}]),onClick:t[0]||(t[0]=s=>r.selectLoginType("admin"))},[...t[11]||(t[11]=[k('<div class="w-12 h-12 bg-gradient-to-br from-[#1B3C53] to-[#234C6A] rounded-xl flex items-center justify-center text-white" data-v-cdaf838a><span class="material-icons" data-v-cdaf838a>admin_panel_settings</span></div><div class="flex-1" data-v-cdaf838a><h4 class="font-bold text-gray-800 dark:text-white" data-v-cdaf838a>مدير النظام</h4><p class="text-xs text-gray-600 dark:text-gray-400 mt-1" data-v-cdaf838a>صلاحيات كاملة على النظام</p></div>',2)])],2),e("div",{class:w(["flex items-center gap-3 p-4 border border-gray-200 dark:border-gray-600 rounded-xl hover:border-[#1B3C53] dark:hover:border-blue-600 transition-all duration-200 cursor-pointer",{"border-[#1B3C53] dark:border-blue-600 bg-blue-50 dark:bg-blue-900/20":r.selectedLoginType==="user"}]),onClick:t[1]||(t[1]=s=>r.selectLoginType("user"))},[...t[12]||(t[12]=[k('<div class="w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center text-white" data-v-cdaf838a><span class="material-icons" data-v-cdaf838a>person</span></div><div class="flex-1" data-v-cdaf838a><h4 class="font-bold text-gray-800 dark:text-white" data-v-cdaf838a>مستفيد</h4><p class="text-xs text-gray-600 dark:text-gray-400 mt-1" data-v-cdaf838a>تصفح المحتوى والتفاعل</p></div>',2)])],2),e("div",{class:w(["flex items-center gap-3 p-4 border border-gray-200 dark:border-gray-600 rounded-xl hover:border-[#1B3C53] dark:hover:border-blue-600 transition-all duration-200 cursor-pointer",{"border-[#1B3C53] dark:border-blue-600 bg-blue-50 dark:bg-blue-900/20":r.selectedLoginType==="employee"}]),onClick:t[2]||(t[2]=s=>r.selectLoginType("employee"))},[...t[13]||(t[13]=[k('<div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-xl flex items-center justify-center text-white" data-v-cdaf838a><span class="material-icons" data-v-cdaf838a>engineering</span></div><div class="flex-1" data-v-cdaf838a><h4 class="font-bold text-gray-800 dark:text-white" data-v-cdaf838a>موظف</h4><p class="text-xs text-gray-600 dark:text-gray-400 mt-1" data-v-cdaf838a>إدارة المحتوى والمستخدمين</p></div>',2)])],2)]),e("div",re,[t[15]||(t[15]=e("h4",{class:"text-sm font-bold text-gray-800 dark:text-white mb-3"},"حسابات تجريبية",-1)),e("div",oe,[(g(!0),m(J,null,R(r.demoAccounts,s=>(g(),m("div",{key:s.type,class:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors duration-200",onClick:T=>r.fillCredentials(s.type)},[e("div",se,[e("div",null,[e("p",ne,l(s.name),1),e("p",le,l(s.email),1)]),t[14]||(t[14]=e("span",{class:"material-icons text-gray-400 text-sm"},"content_copy",-1))])],8,ae))),128))])])])]),e("div",ie,[e("div",de,[e("div",ce,[e("div",ge,[e("div",me,[t[18]||(t[18]=e("span",{class:"material-icons text-2xl"},"login",-1)),e("div",null,[t[17]||(t[17]=e("h2",{class:"text-xl font-bold"},"تسجيل الدخول",-1)),e("p",pe,l(r.selectedLoginType?r.getLoginTypeInfo(r.selectedLoginType).description:"اختر نوع الحساب"),1)])]),r.selectedLoginType?(g(),m("div",ye,[e("span",ue,l(r.getLoginTypeInfo(r.selectedLoginType).icon),1),e("span",xe,l(r.getLoginTypeInfo(r.selectedLoginType).name),1)])):B("",!0)])]),e("div",be,[r.selectedLoginType?(g(),m("div",ve,[e("form",{onSubmit:t[9]||(t[9]=z((...s)=>r.performLogin&&r.performLogin(...s),["prevent"])),class:"space-y-6"},[e("div",he,[e("div",we,[e("div",{class:"w-10 h-10 rounded-xl flex items-center justify-center text-white",style:q(r.getLoginTypeStyle(r.selectedLoginType))},[e("span",ke,l(r.getLoginTypeInfo(r.selectedLoginType).icon),1)],4),e("div",null,[e("h4",_e,l(r.getLoginTypeInfo(r.selectedLoginType).name),1),e("p",Te,l(r.getLoginTypeInfo(r.selectedLoginType).description),1)])])]),e("div",Ce,[t[20]||(t[20]=e("label",{class:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-3 flex items-center gap-2"},[e("span",{class:"material-icons text-[#1B3C53] text-lg"},"email"),y(" البريد الإلكتروني * ")],-1)),_(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>r.form.email=s),type:"email",required:"",class:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-[#1B3C53] focus:border-[#1B3C53] bg-white dark:bg-gray-700 dark:text-white transition-all duration-200",placeholder:"ادخل بريدك الإلكتروني",onInput:t[4]||(t[4]=(...s)=>r.clearError&&r.clearError(...s))},null,544),[[F,r.form.email]])]),e("div",Le,[t[21]||(t[21]=e("label",{class:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-3 flex items-center gap-2"},[e("span",{class:"material-icons text-[#1B3C53] text-lg"},"lock"),y(" كلمة المرور * ")],-1)),e("div",Se,[_(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>r.form.password=s),type:r.showPassword?"text":"password",required:"",class:"w-full px-4 py-3 pr-12 border-2 border-gray-300 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-[#1B3C53] focus:border-[#1B3C53] bg-white dark:bg-gray-700 dark:text-white transition-all duration-200",placeholder:"ادخل كلمة المرور",onInput:t[6]||(t[6]=(...s)=>r.clearError&&r.clearError(...s))},null,40,Ie),[[G,r.form.password]]),e("button",{type:"button",onClick:t[7]||(t[7]=s=>r.showPassword=!r.showPassword),class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-[#1B3C53] dark:hover:text-white transition-colors duration-200"},[e("span",Be,l(r.showPassword?"visibility_off":"visibility"),1)])])]),e("div",Ae,[e("div",Ee,[_(e("input",{id:"remember-me","onUpdate:modelValue":t[8]||(t[8]=s=>r.form.rememberMe=s),type:"checkbox",class:"w-4 h-4 text-[#1B3C53] border-gray-300 rounded focus:ring-[#1B3C53] focus:ring-2"},null,512),[[K,r.form.rememberMe]]),t[22]||(t[22]=e("label",{for:"remember-me",class:"text-sm text-gray-700 dark:text-gray-300 cursor-pointer"}," تذكرني على هذا الجهاز ",-1))]),t[23]||(t[23]=e("button",{type:"button",class:"text-sm text-[#1B3C53] dark:text-blue-400 hover:underline transition-colors duration-200"}," نسيت كلمة المرور؟ ",-1))]),r.error?(g(),m("div",De,[e("div",Ne,[t[24]||(t[24]=e("span",{class:"material-icons text-red-500"},"error",-1)),e("div",null,[e("p",Me,l(r.error),1)])])])):B("",!0),e("button",{type:"submit",disabled:r.loading,class:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-[#1B3C53] to-[#234C6A] text-white rounded-xl hover:from-[#234C6A] hover:to-[#1B3C53] disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 font-medium shadow-lg"},[e("span",je,l(r.loading?"autorenew":"login"),1),y(" "+l(r.loading?"جاري تسجيل الدخول...":"تسجيل الدخول"),1)],8,Ue)],32),e("div",Ve,[e("button",{onClick:t[10]||(t[10]=s=>r.fillCredentials(r.selectedLoginType)),class:"w-full flex items-center justify-center gap-2 px-6 py-3 border-2 border-[#1B3C53] text-[#1B3C53] dark:text-white rounded-xl hover:bg-[#1B3C53] hover:text-white transition-all duration-200 font-medium"},[...t[25]||(t[25]=[e("span",{class:"material-icons"},"play_arrow",-1),y(" استخدام حساب تجريبي ",-1)])])]),e("div",He,[e("p",Oe,[t[27]||(t[27]=y(" ليس لديك حساب؟ ",-1)),I(x,{to:"/register",class:"text-[#1B3C53] dark:text-blue-400 font-bold hover:underline transition-colors duration-200"},{default:Q(()=>[...t[26]||(t[26]=[y(" أنشئ حساب جديد ",-1)])]),_:1})])])])):(g(),m("div",fe,[...t[19]||(t[19]=[e("span",{class:"material-icons text-6xl text-gray-400 mb-4"},"account_circle",-1),e("h3",{class:"text-xl font-bold text-gray-800 dark:text-white mb-2"},"اختر نوع الحساب",-1),e("p",{class:"text-gray-600 dark:text-gray-400"},"يرجى اختيار نوع الحساب من القائمة الجانبية للمتابعة",-1)])]))])])])])])])}const Re=H(W,[["render",Pe],["__scopeId","data-v-cdaf838a"]]);export{Re as default};
