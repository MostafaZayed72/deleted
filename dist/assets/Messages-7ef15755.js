import{_ as ge,r as x,c as M,o as ce,a as xe,b as l,d as i,e as be,f as e,h as p,t as n,w as j,v as N,n as d,j as y,F as h,l as D,s as A,i as F,m as ue,y as ye,C as O}from"./index-85c8a86e.js";const me={name:"Messages",setup(){const b=x([]),t=x(null),S=x(""),r=x(""),B=x(!1),R=x(!1),v=x(!1),k=x(""),s=x(""),m=x(!1),w=x("all"),_=x(null),u=x(null),f=JSON.parse(localStorage.getItem("userData")||"{}"),V=x(["ðŸ˜€","ðŸ˜‚","ðŸ¥°","ðŸ˜Ž","ðŸ¤”","ðŸ‘","â¤ï¸","ðŸ”¥","âœ¨","ðŸŽ‰","ðŸ™","ðŸ’¯"]),z=M(()=>{const a=b.value.length,o=b.value.reduce((g,de)=>g+de.unreadCount,0),c=b.value.filter(g=>new Date-new Date(g.lastMessage.timestamp)<864e5).length;return{totalConversations:a,unreadMessages:o,activeChats:c,avgResponseTime:12}}),J=M(()=>{let a=b.value;if(S.value){const o=S.value.toLowerCase();a=a.filter(c=>c.participant.name.toLowerCase().includes(o)||c.lastMessage.text.toLowerCase().includes(o)||E(c.participant.role).toLowerCase().includes(o))}return w.value==="unread"?a=a.filter(o=>o.unreadCount>0):w.value==="important"&&(a=a.filter(o=>o.important)),a}),U=M(()=>JSON.parse(localStorage.getItem("libraryUsers")||"[]").filter(o=>o.id!==f.id)),P=M(()=>U.value.filter(a=>a.role==="admin"||a.role==="employee")),H=M(()=>U.value.filter(a=>a.role==="user")),T=()=>{const a=`conversations_${f.id}`;b.value=JSON.parse(localStorage.getItem(a)||"[]")},C=()=>{const a=`conversations_${f.id}`;localStorage.setItem(a,JSON.stringify(b.value))},L=a=>{t.value=a,R.value=!1,v.value=!1,a.unreadCount>0&&(a.unreadCount=0,a.messages.forEach(o=>{o.sender!==f.id&&(o.read=!0)}),C()),O(()=>{I(),u.value&&u.value.focus()})},K=()=>{if(!r.value.trim()||!t.value)return;const a={id:Date.now(),sender:f.id,text:r.value.trim(),timestamp:new Date().toISOString(),read:!1};t.value.messages.push(a),t.value.lastMessage=a,C(),r.value="",v.value=!1,u.value&&(u.value.style.height="auto"),O(()=>{I()})},Q=()=>{if(!k.value||!s.value.trim())return;const a=U.value.find(g=>g.id===k.value);if(!a)return;const o={id:Date.now(),sender:f.id,text:s.value.trim(),timestamp:new Date().toISOString(),read:!1},c={id:Date.now(),participant:a,messages:[o],lastMessage:o,unreadCount:0,online:Math.random()>.5,important:m.value};b.value.unshift(c),C(),B.value=!1,k.value="",s.value="",m.value=!1,L(c)},I=()=>{_.value&&(_.value.scrollTop=_.value.scrollHeight)},q=()=>{u.value&&(u.value.style.height="auto",u.value.style.height=u.value.scrollHeight+"px")},G=()=>{v.value=!v.value},W=a=>{r.value+=a,v.value=!1,u.value&&u.value.focus()},X=a=>{w.value=a},Y=()=>{T()},Z=()=>{t.value&&(t.value.important=!t.value.important,C())},$=()=>{if(!t.value)return;const a={participant:t.value.participant.name,messages:t.value.messages,exportDate:new Date().toISOString()},o=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),c=URL.createObjectURL(o),g=document.createElement("a");g.href=c,g.download=`conversation-${t.value.id}.json`,g.click(),URL.revokeObjectURL(c)},ee=a=>{const o=new Date(a),g=new Date-o;return g<6e4?"Ø§Ù„Ø¢Ù†":g<36e5?`Ù…Ù†Ø° ${Math.floor(g/6e4)} Ø¯Ù‚ÙŠÙ‚Ø©`:g<864e5?o.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"}):g<6048e5?o.toLocaleDateString("ar-SA",{weekday:"long"}):o.toLocaleDateString("ar-SA",{year:"numeric",month:"short",day:"numeric"})},te=a=>a?new Date(a).toLocaleDateString("ar-SA",{year:"numeric",month:"long",day:"numeric"}):"ØºÙŠØ± Ù…Ø­Ø¯Ø¯",re=a=>new Date(a).toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"}),se=a=>{if(a===0)return!0;const o=new Date(t.value.messages[a].timestamp),c=new Date(t.value.messages[a-1].timestamp);return o.toDateString()!==c.toDateString()},ae=a=>a.split(" ").map(o=>o[0]).join("").toUpperCase().slice(0,2),oe=a=>({admin:"bg-red-500",employee:"bg-blue-500",user:"bg-green-500"})[a]||"bg-gray-500",ne=a=>({admin:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",employee:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",user:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300"})[a]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300",E=a=>({admin:"Ù…Ø¯ÙŠØ±",employee:"Ù…ÙˆØ¸Ù",user:"Ù…Ø³ØªÙÙŠØ¯"})[a]||a,le=()=>{t.value&&(t.value.unreadCount=0,t.value.messages.forEach(a=>{a.sender!==f.id&&(a.read=!0)}),C())},ie=()=>{t.value&&confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©ØŸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡.")&&(b.value=b.value.filter(a=>a.id!==t.value.id),C(),t.value=null,R.value=!1)};return ce(()=>{T()}),{conversations:b,selectedConversation:t,searchQuery:S,newMessage:r,showNewMessageModal:B,showConversationInfo:R,showEmojiPicker:v,newMessageRecipient:k,newMessageText:s,markAsImportant:m,currentFilter:w,messagesContainer:_,messageInput:u,currentUser:f,emojis:V,stats:z,filteredConversations:J,availableRecipients:U,adminRecipients:P,userRecipients:H,selectConversation:L,sendMessage:K,createNewConversation:Q,formatDate:ee,formatMessageDate:te,formatMessageTime:re,showDateSeparator:se,getInitials:ae,getUserColor:oe,getRoleBadgeClass:ne,getUserRole:E,markConversationAsRead:le,deleteConversation:ie,toggleEmojiPicker:G,addEmoji:W,setFilter:X,refreshConversations:Y,toggleImportant:Z,exportConversation:$,autoResize:q,scrollToBottom:I}}},ve={class:"min-h-screen bg-gray-50 dark:bg-gray-900"},fe={class:"container mx-auto px-4 py-8"},pe={class:"max-w-7xl mx-auto"},ke={class:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4 mb-8"},we={class:"flex flex-wrap gap-3"},he={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8"},Ce={class:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700"},_e={class:"flex items-center gap-3"},Me={class:"text-2xl font-bold text-gray-800 dark:text-white"},je={class:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700"},De={class:"flex items-center gap-3"},Se={class:"text-2xl font-bold text-gray-800 dark:text-white"},Re={class:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700"},Ue={class:"flex items-center gap-3"},Be={class:"text-2xl font-bold text-gray-800 dark:text-white"},Ie={class:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700"},Ne={class:"flex items-center gap-3"},Ae={class:"text-2xl font-bold text-gray-800 dark:text-white"},Te={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden"},Le={class:"grid grid-cols-1 lg:grid-cols-4 min-h-[600px]"},Ee={class:"lg:col-span-1 border-l border-gray-200 dark:border-gray-700 flex flex-col"},Fe={class:"p-4 border-b border-gray-200 dark:border-gray-700"},Oe={class:"relative mb-3"},Ve={class:"flex gap-1"},ze={class:"flex-1 overflow-y-auto"},Je={key:0,class:"p-8 text-center text-gray-500 dark:text-gray-400"},Pe=["onClick"],He={class:"flex items-start gap-3"},Ke={class:"relative flex-shrink-0"},Qe={class:"flex-1 min-w-0"},qe={class:"flex justify-between items-start mb-1"},Ge={class:"flex items-center gap-2"},We={class:"font-semibold text-gray-800 dark:text-white truncate text-sm"},Xe={class:"text-xs text-gray-500 whitespace-nowrap"},Ye={class:"text-sm text-gray-600 dark:text-gray-300 truncate mb-2 leading-relaxed"},Ze={class:"flex justify-between items-center"},$e={key:1},et={class:"flex items-center gap-1"},tt={key:0,class:"text-yellow-500 material-icons text-sm",title:"Ù…Ù‡Ù…"},rt={key:1,class:"bg-[#1B3C53] text-white text-xs px-2 py-1 rounded-full min-w-5 h-5 flex items-center justify-center"},st={class:"lg:col-span-3 flex flex-col"},at={class:"p-4 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 flex justify-between items-center"},ot={class:"flex items-center gap-3"},nt={class:"relative"},lt={class:"flex items-center gap-2"},it={class:"font-semibold text-gray-800 dark:text-white"},dt={class:"flex items-center gap-2"},gt=["title"],ct={class:"material-icons"},xt={ref:"messagesContainer",class:"flex-1 p-6 space-y-4 overflow-y-auto bg-gray-50 dark:bg-gray-900"},bt={key:0,class:"text-center py-4"},ut={key:0,class:"flex justify-center my-6"},yt={class:"bg-white dark:bg-gray-800 text-gray-500 text-sm px-4 py-2 rounded-full border border-gray-200 dark:border-gray-700"},mt={class:"text-sm leading-relaxed mb-2"},vt={class:"flex justify-end items-center gap-2"},ft={class:"p-4 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"},pt={class:"flex-1 relative"},kt={key:0,class:"absolute bottom-full left-0 mb-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl shadow-xl p-3 w-64 h-40 overflow-y-auto"},wt={class:"grid grid-cols-8 gap-1"},ht=["onClick"],Ct=["disabled"],_t={key:1,class:"flex-1 flex flex-col items-center justify-center text-center p-8 bg-gray-50 dark:bg-gray-900"},Mt={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},jt={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-lg"},Dt={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},St={class:"p-6"},Rt={class:"mb-4"},Ut={label:"ÙØ±ÙŠÙ‚ Ø§Ù„Ø¹Ù…Ù„"},Bt=["value"],It={label:"Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ÙŠÙ†"},Nt=["value"],At={class:"mb-4"},Tt={class:"flex items-center justify-between"},Lt={class:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400"},Et={class:"text-sm text-gray-500"},Ft={class:"flex justify-end gap-3 p-6 border-t border-gray-200 dark:border-gray-700"},Ot=["disabled"],Vt={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},zt={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-md"},Jt={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},Pt={class:"p-6 space-y-4"},Ht={class:"text-center"},Kt={class:"font-semibold text-gray-800 dark:text-white"},Qt={class:"text-sm text-gray-500"},qt={class:"grid grid-cols-2 gap-4 text-sm"},Gt={class:"bg-gray-50 dark:bg-gray-700 p-3 rounded-lg"},Wt={class:"font-semibold text-gray-800 dark:text-white"},Xt={class:"bg-gray-50 dark:bg-gray-700 p-3 rounded-lg"},Yt={class:"font-semibold text-gray-800 dark:text-white"},Zt={class:"border-t border-gray-200 dark:border-gray-700 pt-4"};function $t(b,t,S,r,B,R){var k;const v=xe("AppHeader");return l(),i("div",ve,[be(v),e("div",fe,[e("div",pe,[e("div",ke,[t[27]||(t[27]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-800 dark:text-white mb-2"}," ðŸ“¨ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„ÙˆØ§Ø±Ø¯ "),e("p",{class:"text-gray-600 dark:text-gray-400"}," Ø¥Ø¯Ø§Ø±Ø© Ù…Ø­Ø§Ø¯Ø«Ø§ØªÙƒ ÙˆØ±Ø³Ø§Ø¦Ù„Ùƒ Ù…Ø¹ ÙØ±ÙŠÙ‚ Ø§Ù„Ø¹Ù…Ù„ ÙˆØ§Ù„Ù…Ø³ØªÙÙŠØ¯ÙŠÙ† ")],-1)),e("div",we,[e("button",{onClick:t[0]||(t[0]=(...s)=>r.refreshConversations&&r.refreshConversations(...s)),class:"flex items-center gap-2 px-4 py-2 text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"},[...t[25]||(t[25]=[e("span",{class:"material-icons text-sm"},"refresh",-1),p(" ØªØ­Ø¯ÙŠØ« ",-1)])]),e("button",{onClick:t[1]||(t[1]=s=>r.showNewMessageModal=!0),class:"flex items-center gap-2 px-4 py-2 bg-[#1B3C53] text-white rounded-xl hover:bg-[#234C6A] transition-colors"},[...t[26]||(t[26]=[e("span",{class:"material-icons text-sm"},"add",-1),p(" Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© ",-1)])])])]),e("div",he,[e("div",Ce,[e("div",_e,[t[29]||(t[29]=e("div",{class:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg"},[e("span",{class:"material-icons text-blue-600 dark:text-blue-400"},"chat")],-1)),e("div",null,[e("p",Me,n(r.stats.totalConversations),1),t[28]||(t[28]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª",-1))])])]),e("div",je,[e("div",De,[t[31]||(t[31]=e("div",{class:"p-2 bg-green-100 dark:bg-green-900 rounded-lg"},[e("span",{class:"material-icons text-green-600 dark:text-green-400"},"mark_email_read")],-1)),e("div",null,[e("p",Se,n(r.stats.unreadMessages),1),t[30]||(t[30]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Ø±Ø³Ø§Ø¦Ù„ ØºÙŠØ± Ù…Ù‚Ø±ÙˆØ¡Ø©",-1))])])]),e("div",Re,[e("div",Ue,[t[33]||(t[33]=e("div",{class:"p-2 bg-purple-100 dark:bg-purple-900 rounded-lg"},[e("span",{class:"material-icons text-purple-600 dark:text-purple-400"},"group")],-1)),e("div",null,[e("p",Be,n(r.stats.activeChats),1),t[32]||(t[32]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ù†Ø´Ø·Ø©",-1))])])]),e("div",Ie,[e("div",Ne,[t[35]||(t[35]=e("div",{class:"p-2 bg-orange-100 dark:bg-orange-900 rounded-lg"},[e("span",{class:"material-icons text-orange-600 dark:text-orange-400"},"schedule")],-1)),e("div",null,[e("p",Ae,n(r.stats.avgResponseTime)+"m",1),t[34]||(t[34]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Ù…ØªÙˆØ³Ø· ÙˆÙ‚Øª Ø§Ù„Ø±Ø¯",-1))])])])]),e("div",Te,[e("div",Le,[e("div",Ee,[e("div",Fe,[e("div",Oe,[j(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>r.searchQuery=s),type:"text",placeholder:"Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª...",class:"w-full pl-10 pr-4 py-3 bg-gray-100 dark:bg-gray-700 rounded-xl text-gray-800 dark:text-white focus:ring-2 focus:ring-[#1B3C53] focus:border-transparent"},null,512),[[N,r.searchQuery]]),t[36]||(t[36]=e("span",{class:"material-icons absolute right-3 top-3 text-gray-400 text-sm"}," search ",-1))]),e("div",Ve,[e("button",{onClick:t[3]||(t[3]=s=>r.setFilter("all")),class:d(["flex-1 px-3 py-1 text-xs rounded-lg transition-colors",r.currentFilter==="all"?"bg-[#1B3C53] text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"])}," Ø§Ù„ÙƒÙ„ ",2),e("button",{onClick:t[4]||(t[4]=s=>r.setFilter("unread")),class:d(["flex-1 px-3 py-1 text-xs rounded-lg transition-colors",r.currentFilter==="unread"?"bg-[#1B3C53] text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"])}," ØºÙŠØ± Ù…Ù‚Ø±ÙˆØ¡ ",2),e("button",{onClick:t[5]||(t[5]=s=>r.setFilter("important")),class:d(["flex-1 px-3 py-1 text-xs rounded-lg transition-colors",r.currentFilter==="important"?"bg-[#1B3C53] text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"])}," Ù…Ù‡Ù… ",2)])]),e("div",ze,[r.filteredConversations.length===0?(l(),i("div",Je,[t[37]||(t[37]=e("span",{class:"material-icons text-4xl mb-3 text-gray-300"},"inbox",-1)),t[38]||(t[38]=e("p",null,"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§Ø¯Ø«Ø§Øª",-1)),e("button",{onClick:t[6]||(t[6]=s=>r.showNewMessageModal=!0),class:"mt-2 text-[#1B3C53] dark:text-blue-400 hover:underline text-sm"}," Ø§Ø¨Ø¯Ø£ Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø© ")])):y("",!0),(l(!0),i(h,null,D(r.filteredConversations,s=>{var m,w;return l(),i("div",{key:s.id,onClick:_=>r.selectConversation(s),class:d(["p-4 border-b border-gray-100 dark:border-gray-700 cursor-pointer transition-all duration-200",{"bg-blue-50 dark:bg-blue-900/20 border-r-4 border-r-[#1B3C53]":((m=r.selectedConversation)==null?void 0:m.id)===s.id,"hover:bg-gray-50 dark:hover:bg-gray-700":((w=r.selectedConversation)==null?void 0:w.id)!==s.id}])},[e("div",He,[e("div",Ke,[e("div",{class:d(["w-12 h-12 rounded-full flex items-center justify-center text-white text-sm font-semibold shadow-lg",r.getUserColor(s.participant.role)])},n(r.getInitials(s.participant.name)),3),e("span",{class:d(["absolute -bottom-0.5 -right-0.5 w-3 h-3 border-2 border-white dark:border-gray-800 rounded-full",s.online?"bg-green-500":"bg-gray-400"])},null,2)]),e("div",Qe,[e("div",qe,[e("div",Ge,[e("h3",We,n(s.participant.name),1),e("span",{class:d(["text-xs px-2 py-1 rounded-full",r.getRoleBadgeClass(s.participant.role)])},n(r.getUserRole(s.participant.role)),3)]),e("span",Xe,n(r.formatDate(s.lastMessage.timestamp)),1)]),e("p",Ye,n(s.lastMessage.text),1),e("div",Ze,[s.lastMessage.sender===r.currentUser.id?(l(),i("span",{key:0,class:d(["text-xs flex items-center gap-1",s.lastMessage.read?"text-green-500":"text-gray-400"])},[t[39]||(t[39]=e("span",{class:"material-icons text-xs"},"done_all",-1)),p(" "+n(s.lastMessage.read?"ØªÙ… Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©":"ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„"),1)],2)):(l(),i("span",$e)),e("div",et,[s.important?(l(),i("span",tt,"star")):y("",!0),s.unreadCount>0?(l(),i("span",rt,n(s.unreadCount),1)):y("",!0)])])])])],10,Pe)}),128))])]),e("div",st,[r.selectedConversation?(l(),i(h,{key:0},[e("div",at,[e("div",ot,[e("div",nt,[e("div",{class:d(["w-12 h-12 rounded-full flex items-center justify-center text-white text-sm font-semibold shadow-lg",r.getUserColor(r.selectedConversation.participant.role)])},n(r.getInitials(r.selectedConversation.participant.name)),3),e("span",{class:d(["absolute -bottom-0.5 -right-0.5 w-3 h-3 border-2 border-white dark:border-gray-800 rounded-full",r.selectedConversation.online?"bg-green-500":"bg-gray-400"])},null,2)]),e("div",null,[e("div",lt,[e("h3",it,n(r.selectedConversation.participant.name),1),e("span",{class:d(["text-xs px-2 py-1 rounded-full",r.getRoleBadgeClass(r.selectedConversation.participant.role)])},n(r.getUserRole(r.selectedConversation.participant.role)),3)]),e("p",{class:d(["text-sm flex items-center gap-1",r.selectedConversation.online?"text-green-500":"text-gray-500"])},[e("span",{class:d(["w-2 h-2 rounded-full",r.selectedConversation.online?"bg-green-500":"bg-gray-400"])},null,2),p(" "+n(r.selectedConversation.online?"Ù…ØªØµÙ„ Ø§Ù„Ø¢Ù†":"ØºÙŠØ± Ù…ØªØµÙ„"),1)],2)])]),e("div",dt,[e("button",{onClick:t[7]||(t[7]=(...s)=>r.toggleImportant&&r.toggleImportant(...s)),class:d(["p-2 text-gray-400 transition-colors",r.selectedConversation.important?"text-yellow-500":"hover:text-yellow-500"]),title:r.selectedConversation.important?"Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙ…ÙŠÙŠØ²":"ØªÙ…ÙŠÙŠØ² ÙƒÙ…Ù‡Ù…"},[e("span",ct,n(r.selectedConversation.important?"star":"star_border"),1)],10,gt),r.selectedConversation.unreadCount?(l(),i("button",{key:0,onClick:t[8]||(t[8]=(...s)=>r.markConversationAsRead&&r.markConversationAsRead(...s)),class:"p-2 text-gray-400 hover:text-green-500 transition-colors",title:"ØªØ¹Ù„ÙŠÙ… ÙƒÙ…Ù‚Ø±ÙˆØ¡"},[...t[40]||(t[40]=[e("span",{class:"material-icons"},"mark_email_read",-1)])])):y("",!0),e("button",{onClick:t[9]||(t[9]=s=>r.showConversationInfo=!0),class:"p-2 text-gray-400 hover:text-blue-500 transition-colors",title:"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©"},[...t[41]||(t[41]=[e("span",{class:"material-icons"},"info",-1)])]),e("button",{onClick:t[10]||(t[10]=(...s)=>r.deleteConversation&&r.deleteConversation(...s)),class:"p-2 text-gray-400 hover:text-red-500 transition-colors",title:"Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©"},[...t[42]||(t[42]=[e("span",{class:"material-icons"},"delete",-1)])])])]),e("div",xt,[r.selectedConversation.messages.length>0?(l(),i("div",bt,[...t[43]||(t[43]=[e("span",{class:"text-sm text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-800 px-4 py-2 rounded-full border border-gray-200 dark:border-gray-700"}," Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© ",-1)])])):y("",!0),(l(!0),i(h,null,D(r.selectedConversation.messages,(s,m)=>(l(),i(h,{key:s.id},[r.showDateSeparator(m)?(l(),i("div",ut,[e("span",yt,n(r.formatMessageDate(s.timestamp)),1)])):y("",!0),e("div",{class:d(["flex gap-3 group",s.sender===r.currentUser.id?"justify-end":"justify-start"])},[s.sender!==r.currentUser.id?(l(),i("div",{key:0,class:d(["w-10 h-10 rounded-full flex items-center justify-center text-white text-sm font-semibold flex-shrink-0",r.getUserColor(r.selectedConversation.participant.role)])},n(r.getInitials(r.selectedConversation.participant.name)),3)):y("",!0),e("div",{class:d(["max-w-[70%] p-4 rounded-2xl relative transition-all duration-200 group-hover:shadow-lg",[s.sender===r.currentUser.id?"bg-[#1B3C53] text-white rounded-br-none":"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-bl-none"]])},[e("p",mt,n(s.text),1),e("div",vt,[e("span",{class:d(["text-xs",s.sender===r.currentUser.id?"text-blue-200":"text-gray-500 dark:text-gray-400"])},n(r.formatMessageTime(s.timestamp)),3),s.sender===r.currentUser.id?(l(),i("span",{key:0,class:d(["flex items-center gap-1 text-xs",s.read?"text-green-300":"text-blue-200"])},[t[44]||(t[44]=e("span",{class:"material-icons text-xs"},"done_all",-1)),p(" "+n(s.read?"ØªÙ… Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©":"ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„"),1)],2)):y("",!0)]),e("div",{class:d(["absolute w-3 h-3 transform rotate-45",[s.sender===r.currentUser.id?"bg-[#1B3C53] -right-1 top-0":"bg-white dark:bg-gray-800 border-l border-b border-gray-200 dark:border-gray-700 -left-1 top-0"]])},null,2)],2)],2)],64))),128))],512),e("div",ft,[e("form",{onSubmit:t[16]||(t[16]=A((...s)=>r.sendMessage&&r.sendMessage(...s),["prevent"])),class:"flex gap-3"},[e("button",{type:"button",onClick:t[11]||(t[11]=(...s)=>r.toggleEmojiPicker&&r.toggleEmojiPicker(...s)),class:"p-3 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors"},[...t[45]||(t[45]=[e("span",{class:"material-icons"},"mood",-1)])]),e("div",pt,[j(e("textarea",{ref:"messageInput","onUpdate:modelValue":t[12]||(t[12]=s=>r.newMessage=s),onKeydown:[t[13]||(t[13]=F(A((...s)=>r.sendMessage&&r.sendMessage(...s),["exact","prevent"]),["enter"])),t[14]||(t[14]=F(A(s=>r.newMessage+=`
`,["shift","exact","prevent"]),["enter"]))],placeholder:"Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ...",rows:"1",class:"w-full px-4 py-3 bg-gray-100 dark:bg-gray-700 rounded-xl text-gray-800 dark:text-white resize-none max-h-32 focus:ring-2 focus:ring-[#1B3C53] focus:border-transparent",onInput:t[15]||(t[15]=(...s)=>r.autoResize&&r.autoResize(...s))},null,544),[[N,r.newMessage]]),r.showEmojiPicker?(l(),i("div",kt,[e("div",wt,[(l(!0),i(h,null,D(r.emojis,s=>(l(),i("button",{key:s,onClick:m=>r.addEmoji(s),class:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded text-lg"},n(s),9,ht))),128))])])):y("",!0)]),e("button",{type:"submit",disabled:!r.newMessage.trim(),class:"px-6 py-3 bg-[#1B3C53] text-white rounded-xl hover:bg-[#234C6A] disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2"},[...t[46]||(t[46]=[e("span",{class:"material-icons text-sm"},"send",-1),p(" Ø¥Ø±Ø³Ø§Ù„ ",-1)])],8,Ct)],32)])],64)):(l(),i("div",_t,[...t[47]||(t[47]=[e("span",{class:"material-icons text-6xl text-gray-300 dark:text-gray-600 mb-4"}," chat_bubble_outline ",-1),e("h3",{class:"text-xl font-semibold text-gray-600 dark:text-gray-400 mb-2"}," Ø§Ø®ØªØ± Ù…Ø­Ø§Ø¯Ø«Ø© Ù„Ù„Ø¨Ø¯Ø¡ ",-1),e("p",{class:"text-gray-500 dark:text-gray-500 max-w-md"}," Ø§Ø®ØªØ± Ù…Ø­Ø§Ø¯Ø«Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø±Ø§Ø³Ù„Ø© Ø£Ùˆ Ø§Ø¨Ø¯Ø£ Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù…Ø¹ ÙØ±ÙŠÙ‚ Ø§Ù„Ø¹Ù…Ù„ Ø£Ùˆ Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ÙŠÙ† ",-1)])]))])])])])]),r.showNewMessageModal?(l(),i("div",Mt,[e("div",jt,[e("div",Dt,[t[49]||(t[49]=e("h3",{class:"text-lg font-semibold text-gray-800 dark:text-white"}," Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© ",-1)),e("button",{onClick:t[17]||(t[17]=s=>r.showNewMessageModal=!1),class:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...t[48]||(t[48]=[e("span",{class:"material-icons"},"close",-1)])])]),e("div",St,[e("div",Rt,[t[51]||(t[51]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 text-right"}," Ø¥Ù„Ù‰ ",-1)),j(e("select",{"onUpdate:modelValue":t[18]||(t[18]=s=>r.newMessageRecipient=s),class:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-[#1B3C53] focus:border-transparent"},[t[50]||(t[50]=e("option",{value:""},"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³ØªÙ„Ù…",-1)),e("optgroup",Ut,[(l(!0),i(h,null,D(r.adminRecipients,s=>(l(),i("option",{key:s.id,value:s.id},n(s.name)+" ("+n(r.getUserRole(s.role))+") ",9,Bt))),128))]),e("optgroup",It,[(l(!0),i(h,null,D(r.userRecipients,s=>(l(),i("option",{key:s.id,value:s.id},n(s.name)+" ("+n(r.getUserRole(s.role))+") ",9,Nt))),128))])],512),[[ue,r.newMessageRecipient]])]),e("div",At,[t[52]||(t[52]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 text-right"}," Ø§Ù„Ø±Ø³Ø§Ù„Ø© ",-1)),j(e("textarea",{"onUpdate:modelValue":t[19]||(t[19]=s=>r.newMessageText=s),rows:"4",class:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-800 dark:text-white resize-none focus:ring-2 focus:ring-[#1B3C53] focus:border-transparent",placeholder:"Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..."},null,512),[[N,r.newMessageText]])]),e("div",Tt,[e("label",Lt,[j(e("input",{type:"checkbox","onUpdate:modelValue":t[20]||(t[20]=s=>r.markAsImportant=s),class:"rounded text-[#1B3C53] focus:ring-[#1B3C53]"},null,512),[[ye,r.markAsImportant]]),t[53]||(t[53]=p(" ØªØ¹ÙŠÙŠÙ† ÙƒÙ…Ù‡Ù… ",-1))]),e("div",Et,n(r.newMessageText.length)+"/500 ",1)])]),e("div",Ft,[e("button",{onClick:t[21]||(t[21]=s=>r.showNewMessageModal=!1),class:"px-6 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white transition-colors"}," Ø¥Ù„ØºØ§Ø¡ "),e("button",{onClick:t[22]||(t[22]=(...s)=>r.createNewConversation&&r.createNewConversation(...s)),disabled:!r.newMessageRecipient||!r.newMessageText.trim(),class:"px-6 py-2 bg-[#1B3C53] text-white rounded-xl hover:bg-[#234C6A] disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2"},[...t[54]||(t[54]=[e("span",{class:"material-icons text-sm"},"send",-1),p(" Ø¥Ø±Ø³Ø§Ù„ ",-1)])],8,Ot)])])])):y("",!0),r.showConversationInfo&&r.selectedConversation?(l(),i("div",Vt,[e("div",zt,[e("div",Jt,[t[56]||(t[56]=e("h3",{class:"text-lg font-semibold text-gray-800 dark:text-white"}," Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© ",-1)),e("button",{onClick:t[23]||(t[23]=s=>r.showConversationInfo=!1),class:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...t[55]||(t[55]=[e("span",{class:"material-icons"},"close",-1)])])]),e("div",Pt,[e("div",Ht,[e("div",{class:d(["w-20 h-20 rounded-full flex items-center justify-center text-white text-xl font-semibold mx-auto mb-3",r.getUserColor(r.selectedConversation.participant.role)])},n(r.getInitials(r.selectedConversation.participant.name)),3),e("h4",Kt,n(r.selectedConversation.participant.name),1),e("p",Qt,n(r.getUserRole(r.selectedConversation.participant.role)),1)]),e("div",qt,[e("div",Gt,[t[57]||(t[57]=e("p",{class:"text-gray-600 dark:text-gray-400"},"Ø¹Ø¯Ø¯ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„",-1)),e("p",Wt,n(r.selectedConversation.messages.length),1)]),e("div",Xt,[t[58]||(t[58]=e("p",{class:"text-gray-600 dark:text-gray-400"},"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡",-1)),e("p",Yt,n(r.formatMessageDate((k=r.selectedConversation.messages[0])==null?void 0:k.timestamp)),1)])]),e("div",Zt,[e("button",{onClick:t[24]||(t[24]=(...s)=>r.exportConversation&&r.exportConversation(...s)),class:"w-full text-center text-[#1B3C53] dark:text-blue-400 hover:underline text-sm py-2"}," ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© ")])])])])):y("",!0)])}const tr=ge(me,[["render",$t],["__scopeId","data-v-97b96c09"]]);export{tr as default};
