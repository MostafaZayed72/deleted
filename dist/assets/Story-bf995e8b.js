import{_ as _t,u as St,q as At,r as x,c as Ct,o as Tt,S as g,a as H,b as i,d,e as V,f as t,k as M,t as a,h as T,n as P,F as R,l as j,w as B,v as G,T as Rt,j as E}from"./index-85c8a86e.js";const jt={name:"StoryView",setup(){const _=St(),e=At(),n=x(null),r=x(!1),S=x(!1),I=x(""),L=x(5),m=x([]),s=x([]),v=x(!1),p=x({watchTime:"0 دقيقة",completedStories:0,comments:0,ratings:0}),h=x(!1),f=x(null),F=x(!1),c=x({views:0,likes:0,downloads:0,shares:0}),y=x([]),A=()=>{const o=localStorage.getItem("authToken"),l=localStorage.getItem("userData");return F.value=!!(o&&l),F.value},k=()=>{try{const o=localStorage.getItem("userData");if(o){const l=JSON.parse(o);return l.id||l.userId||"anonymous"}}catch(o){console.error("Error getting user ID:",o)}return"anonymous"},K=()=>{window.addEventListener("storage",o=>{(o.key==="authToken"||o.key==="userData")&&(A(),A()&&h.value&&(h.value=!1,f.value&&(f.value(),f.value=null)))})},q=()=>{try{const o=localStorage.getItem("adminStories")||localStorage.getItem("libraryStories");o&&(y.value=JSON.parse(o))}catch(o){console.error("Error loading stories:",o),y.value=[]}},Q=Ct(()=>{if(!n.value)return[];const l=`${n.value.title} ${n.value.summary}`.split(/\s+/).filter(u=>u.length>3);return[...new Set(l)].slice(0,6)}),C=o=>{A()?o():(f.value=o,h.value=!0)},D=()=>{h.value=!1,f.value=null},W=()=>{const o=e.fullPath;localStorage.setItem("redirectAfterLogin",o),Y()},X=()=>{const o=e.fullPath;localStorage.setItem("redirectAfterLogin",o),Z()},Y=()=>{_.push("/login"),D()},Z=()=>{_.push("/register"),D()},N=()=>{const o=localStorage.getItem("redirectAfterLogin");o&&F.value&&(localStorage.removeItem("redirectAfterLogin"),_.replace(o))},O=()=>{v.value=!v.value,v.value?document.body.style.overflow="hidden":document.body.style.overflow="auto"},$=()=>{C(()=>{var o;if((o=n.value)!=null&&o.story_file){const l=document.createElement("a");l.href=n.value.story_file,l.download=`${n.value.title}.${xt(n.value.story_type)}`,l.click(),g.recordStoryDownload(n.value.id,k()),c.value.downloads++,b()}})},tt=()=>{C(()=>{r.value=!r.value;const o=JSON.parse(localStorage.getItem("userFavorites")||"[]");if(r.value)o.push(n.value.id);else{const l=o.indexOf(n.value.id);l>-1&&o.splice(l,1)}localStorage.setItem("userFavorites",JSON.stringify(o))})},et=()=>{C(()=>{S.value=!S.value,n.value&&(g.recordStoryLike(n.value.id,k()),S.value?c.value.likes++:c.value.likes=Math.max(0,c.value.likes-1),b())})},rt=()=>{C(()=>{navigator.share?navigator.share({title:n.value.title,text:n.value.summary,url:window.location.href}).then(()=>{g.recordStoryShare(n.value.id,k(),"web"),c.value.shares++,b()}):(navigator.clipboard.writeText(window.location.href),alert("تم نسخ رابط القصة إلى الحافظة"),g.recordStoryShare(n.value.id,k(),"copy"),c.value.shares++,b())})},ot=()=>{C(()=>{if(I.value.trim()){const o={id:Date.now(),user:"المستخدم",text:I.value,rating:L.value,date:"الآن",likes:0,replies:[],showReply:!1,replyText:""};if(m.value.unshift(o),g.recordStoryComment(n.value.id,k(),o.id),I.value="",L.value=5,p.value.comments++,n.value){const l=m.value.reduce((u,w)=>u+w.rating,0);n.value.rating=l/m.value.length,J()}alert("شكراً لك! تم إضافة تعليقك بنجاح.")}})},st=o=>{const l=m.value.find(u=>u.id===o);l&&(l.likes=(l.likes||0)+1)},lt=o=>{const l=m.value.find(u=>u.id===o);l&&(l.showReply=!l.showReply,l.replyText||(l.replyText=""))},at=o=>{const l=m.value.find(u=>u.id===o);l&&(l.showReply=!1,l.replyText="")},nt=o=>{var u;const l=m.value.find(w=>w.id===o);if(l&&((u=l.replyText)!=null&&u.trim())){const w={id:Date.now(),user:"المستخدم",text:l.replyText,date:"الآن"};l.replies||(l.replies=[]),l.replies.push(w),l.showReply=!1,l.replyText="",alert("تم إضافة ردك بنجاح.")}},J=()=>{if(n.value){const o=y.value.findIndex(l=>l.id===n.value.id);o!==-1&&(y.value[o]={...n.value},localStorage.setItem("adminStories",JSON.stringify(y.value)))}},b=()=>{n.value&&(n.value.views=c.value.views,n.value.likes=c.value.likes,n.value.downloads=c.value.downloads,n.value.shares=c.value.shares,J())},it=o=>({image:"image",video:"play_circle",audio:"music_note",pdf:"picture_as_pdf",text:"article"})[o]||"description",dt=o=>({image:"صورة",video:"فيديو",audio:"صوت",pdf:"كتاب PDF",text:"نص"})[o]||"محتوى",pt=o=>({published:"منشورة",draft:"مسودة",archived:"مؤرشفة"})[o]||o,ut=o=>o?o.toFixed(1):"0.0",ct=o=>new Date(o).toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric"}),xt=o=>({image:"jpg",video:"mp4",audio:"mp3",pdf:"pdf",text:"txt"})[o]||"file",mt=o=>{_.push(`/story/${o}`)},ft=o=>{_.push(`/story/${o}`),setTimeout(()=>{U(),z(),window.scrollTo({top:0,behavior:"smooth"})},100)},vt=()=>{g.recordStoryView(n.value.id,k()),c.value.views++,b()},gt=()=>{},ht=()=>{g.recordStoryView(n.value.id,k()),c.value.views++,b()},kt=()=>{g.recordStoryView(n.value.id,k()),c.value.views++,b()};Tt(()=>{A(),q(),U(),z(),bt(),wt(),K(),N(),g.recordStoryView(parseInt(e.params.id),k()),yt(),document.addEventListener("keydown",o=>{o.key==="Escape"&&v.value&&O()}),window.addEventListener("storage",()=>{const o=F.value,l=A();!o&&l&&(N(),h.value&&(h.value=!1,f.value&&(f.value(),f.value=null)))}),window.addEventListener("message",o=>{o.data.type==="AUTH_CHANGE"&&o.data.authenticated&&(A(),h.value&&(h.value=!1,f.value&&(f.value(),f.value=null)))})});const U=()=>{const o=parseInt(e.params.id),l=y.value.find(u=>u.id===o);if(l){n.value=l;const u=JSON.parse(localStorage.getItem("userFavorites")||"[]");r.value=u.includes(o);const w=JSON.parse(localStorage.getItem("userLikes")||"[]");S.value=w.includes(o)}else n.value={id:o,vessel_number:"VSL-"+Date.now().toString().slice(-6),title:"عينة من القصة",author:"مؤلف غير معروف",publication_year:"2024",story_type:"pdf",category:"تعليمي",age_group:"7-9 سنوات",status:"published",summary:"هذه قصة تعليمية مفيدة للأطفال تحتوي على قيم تربوية هامة.",rating:4.5,views:0,likes:0,downloads:0,shares:0,created_at:new Date().toISOString(),story_file:null}},yt=()=>{const o=parseInt(e.params.id),l=g.getStoryStatistics(o);c.value={views:l.views,likes:l.likes,downloads:l.downloads,shares:l.shares}},z=()=>{m.value=[{id:1,user:"أم محمد",text:"قصة رائعة! أحبها أطفالي كثيراً وتعلموا منها قيم الشجاعة والتعاون.",rating:5,date:"منذ يومين",likes:3,replies:[{id:101,user:"مدير الموقع",text:"شكراً لك على التعليق الجميل! نحن سعداء لأن القصة نالت إعجاب أطفالك.",date:"منذ يوم"}],showReply:!1,replyText:""},{id:2,user:"والد أحمد",text:"مفيدة وتعليمية للأطفال، المحتوى هادف والرسومات جميلة.",rating:4,date:"منذ أسبوع",likes:1,replies:[],showReply:!1,replyText:""}]},bt=()=>{n.value&&(s.value=y.value.filter(o=>o.id!==n.value.id&&o.category===n.value.category).slice(0,4),s.value.length===0&&(s.value=[{id:2,title:"مغامرات في الغابة",author:"فاطمة علي",story_type:"video",age_group:"7-9 سنوات",category:"تعليمي"},{id:3,title:"رحلة إلى النجوم",author:"محمد عبدالله",story_type:"pdf",age_group:"7-9 سنوات",category:"تعليمي"}]))},wt=()=>{p.value={watchTime:"45 دقيقة",completedStories:12,comments:8,ratings:15}};return{story:n,isFavorite:r,isLiked:S,newComment:I,userRating:L,comments:m,relatedStories:s,storyKeywords:Q,isFullscreen:v,userActivity:p,showAuthModal:h,storyStats:c,checkAuthThen:C,closeAuthModal:D,redirectToLogin:W,redirectToRegister:X,toggleFullscreen:O,downloadFile:$,toggleFavorite:tt,toggleLike:et,shareStory:rt,addComment:ot,toggleCommentLike:st,toggleReply:lt,cancelReply:at,submitReply:nt,getMediaIcon:it,getMediaTypeArabic:dt,getStatusArabic:pt,formatRating:ut,formatDate:ct,viewStory:mt,viewRelatedStory:ft,onVideoPlay:vt,onVideoPause:gt,onAudioPlay:ht,onImageLoad:kt}}},It={dir:"rtl",class:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 dark:from-gray-900 dark:via-purple-900 dark:to-pink-900"},Lt={key:0,class:"container mx-auto px-4 py-6"},Ft={class:"mb-6"},Vt={class:"flex items-center space-x-2 space-x-reverse text-sm text-purple-600 dark:text-purple-400"},Dt={class:"flex items-center space-x-2 space-x-reverse"},Mt={class:"flex items-center space-x-2 space-x-reverse"},Pt={class:"text-purple-700 font-medium"},Et={class:"flex items-center space-x-2 space-x-reverse"},Nt={class:"text-purple-800 dark:text-white font-medium truncate max-w-40"},Ot={class:"grid grid-cols-1 lg:grid-cols-4 gap-6"},Jt={class:"lg:col-span-3 space-y-6"},Ut={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl border border-purple-200 dark:border-purple-700 overflow-hidden transform hover:shadow-3xl transition-all duration-500"},zt={class:"bg-gradient-to-r from-purple-600 to-pink-600 p-4 text-white"},Ht={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},Bt={class:"flex items-center gap-3"},Gt={class:"w-12 h-12 bg-white/20 rounded-2xl flex items-center justify-center"},Kt={class:"material-icons text-2xl"},qt={class:"text-xl font-bold custom-text-pulse"},Qt={class:"text-purple-200 text-sm"},Wt={class:"flex items-center gap-2"},Xt={class:"bg-white/20 px-3 py-1 rounded-full text-sm font-medium transform hover:scale-105 transition-all"},Yt={class:"bg-white/20 px-3 py-1 rounded-full text-sm font-medium transform hover:scale-105 transition-all"},Zt={class:"p-6"},$t={key:0,class:"space-y-4"},te={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},ee={class:"flex items-center gap-2 flex-wrap"},re={class:"material-icons text-sm"},oe={class:"border-2 border-purple-300 dark:border-purple-600 rounded-xl overflow-hidden bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900 dark:to-pink-900 shadow-inner"},se={class:"h-96 sm:h-[500px] lg:h-[600px] transform hover:scale-[1.02] transition-transform duration-500"},le=["src"],ae={key:1,class:"space-y-4"},ne={class:"bg-gradient-to-br from-purple-900 to-pink-900 rounded-2xl overflow-hidden shadow-2xl transform hover:scale-[1.01] transition-all duration-500"},ie=["src"],de={key:2,class:"space-y-6"},pe={class:"bg-gradient-to-r from-purple-100 to-pink-100 dark:from-purple-900 dark:to-pink-900 rounded-2xl p-8 shadow-lg transform hover:scale-[1.02] transition-all duration-500"},ue={class:"text-center"},ce=["src"],xe={key:3,class:"space-y-4"},me={class:"border-2 border-purple-300 dark:border-purple-600 rounded-2xl p-4 bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900 dark:to-pink-900 shadow-lg transform hover:scale-[1.02] transition-all duration-500"},fe={class:"flex justify-center"},ve=["src","alt"],ge={key:4,class:"text-center py-12"},he={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl border border-purple-200 dark:border-purple-700 p-6 transform hover:shadow-3xl transition-all duration-500"},ke={class:"flex flex-wrap items-center justify-between gap-4"},ye={class:"flex items-center gap-4"},be={class:"material-icons text-lg"},we={class:"font-medium"},_e={class:"material-icons text-lg"},Se={class:"flex items-center gap-3"},Ae={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-6 pt-6 border-t border-purple-200 dark:border-purple-600"},Ce={class:"text-center transform hover:scale-110 transition-transform duration-300"},Te={class:"text-2xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent"},Re={class:"text-center transform hover:scale-110 transition-transform duration-300"},je={class:"text-2xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent"},Ie={class:"text-center transform hover:scale-110 transition-transform duration-300"},Le={class:"text-2xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent"},Fe={class:"text-center transform hover:scale-110 transition-transform duration-300"},Ve={class:"text-2xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent"},De={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl border border-purple-200 dark:border-purple-700 p-6 transform hover:shadow-3xl transition-all duration-500"},Me={class:"prose prose-lg max-w-none dark:prose-invert"},Pe={class:"text-purple-700 dark:text-purple-300 leading-relaxed text-lg"},Ee={class:"mt-6 pt-6 border-t border-purple-200 dark:border-purple-600"},Ne={class:"flex flex-wrap gap-2"},Oe={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl border border-purple-200 dark:border-purple-700 p-6 transform hover:shadow-3xl transition-all duration-500"},Je={class:"flex items-center justify-between mb-6"},Ue={class:"flex items-center gap-2 text-yellow-500 transform hover:scale-105 transition-transform"},ze={class:"font-bold"},He={class:"text-purple-600 dark:text-purple-400 text-sm"},Be={class:"bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900 dark:to-pink-900 rounded-2xl p-6 mb-6 shadow-lg"},Ge={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mt-4 gap-4"},Ke={class:"flex items-center gap-3"},qe={class:"flex gap-1"},Qe=["onClick"],We=["disabled"],Xe={class:"space-y-4"},Ye={class:"flex justify-between items-start mb-4"},Ze={class:"flex items-center gap-3"},$e={class:"w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white font-bold text-lg shadow-lg transform hover:rotate-12 transition-transform duration-500"},tr={class:"font-bold text-purple-800 dark:text-white block"},er={class:"text-xs text-purple-500 dark:text-purple-400"},rr={class:"flex items-center gap-1 text-yellow-400 transform hover:scale-110 transition-transform"},or={class:"text-purple-700 dark:text-purple-300 leading-relaxed"},sr={class:"flex items-center gap-4 mt-4 pt-4 border-t border-purple-100 dark:border-purple-700"},lr=["onClick"],ar=["onClick"],nr={key:0,class:"mt-4 pl-6 border-l-2 border-purple-300 dark:border-purple-500 custom-fade-in"},ir=["onUpdate:modelValue"],dr={class:"flex justify-end gap-2 mt-2"},pr=["onClick"],ur=["onClick","disabled"],cr={key:1,class:"mt-4 space-y-3"},xr={class:"flex justify-between items-start mb-2"},mr={class:"flex items-center gap-2"},fr={class:"w-8 h-8 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center text-white font-bold text-sm shadow-md"},vr={class:"font-bold text-sm text-purple-800 dark:text-white"},gr={class:"text-xs text-purple-500 dark:text-purple-400"},hr={class:"text-sm text-purple-700 dark:text-purple-300"},kr={class:"lg:col-span-1 space-y-6"},yr={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl border border-purple-200 dark:border-purple-700 p-6 transform hover:shadow-3xl transition-all duration-500"},br={class:"space-y-4"},wr={class:"flex justify-between items-center p-3 bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900 dark:to-pink-900 rounded-xl transform hover:scale-[1.02] transition-all duration-300"},_r={class:"font-bold text-sm text-purple-800 dark:text-white"},Sr={class:"flex justify-between items-center p-3 bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900 dark:to-pink-900 rounded-xl transform hover:scale-[1.02] transition-all duration-300"},Ar={class:"font-bold text-sm text-purple-800 dark:text-white"},Cr={class:"flex justify-between items-center p-3 bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900 dark:to-pink-900 rounded-xl transform hover:scale-[1.02] transition-all duration-300"},Tr={class:"font-bold text-sm text-purple-800 dark:text-white"},Rr={class:"flex justify-between items-center p-3 bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900 dark:to-pink-900 rounded-xl transform hover:scale-[1.02] transition-all duration-300"},jr={class:"font-bold text-sm text-purple-800 dark:text-white"},Ir={class:"flex justify-between items-center p-3 bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900 dark:to-pink-900 rounded-xl transform hover:scale-[1.02] transition-all duration-300"},Lr={class:"font-bold text-sm text-green-600"},Fr={class:"flex justify-between items-center p-3 bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900 dark:to-pink-900 rounded-xl transform hover:scale-[1.02] transition-all duration-300"},Vr={class:"font-bold text-sm text-purple-800 dark:text-white"},Dr={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl border border-purple-200 dark:border-purple-700 p-6 transform hover:shadow-3xl transition-all duration-500"},Mr={class:"space-y-4"},Pr=["onClick"],Er={class:"w-14 h-14 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center text-white group-hover:scale-110 group-hover:rotate-12 transition-all duration-500 shadow-lg"},Nr={class:"material-icons"},Or={class:"flex-1 min-w-0"},Jr={class:"font-bold text-sm text-purple-800 dark:text-white line-clamp-1 group-hover:text-purple-600 transition-colors duration-300"},Ur={class:"text-xs text-purple-600 dark:text-purple-400 mt-1"},zr={class:"flex items-center gap-2 mt-1"},Hr={class:"text-xs px-2 py-1 bg-gradient-to-r from-purple-100 to-pink-100 text-purple-700 dark:from-purple-800 dark:to-pink-800 dark:text-purple-300 rounded transform group-hover:scale-105 transition-all"},Br={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl border border-purple-200 dark:border-purple-700 p-6 transform hover:shadow-3xl transition-all duration-500"},Gr={class:"space-y-3"},Kr={class:"flex justify-between items-center p-3 bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900 dark:to-pink-900 rounded-xl transform hover:scale-[1.02] transition-all duration-300"},qr={class:"font-bold text-sm bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent"},Qr={class:"flex justify-between items-center p-3 bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900 dark:to-pink-900 rounded-xl transform hover:scale-[1.02] transition-all duration-300"},Wr={class:"font-bold text-sm bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent"},Xr={class:"flex justify-between items-center p-3 bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900 dark:to-pink-900 rounded-xl transform hover:scale-[1.02] transition-all duration-300"},Yr={class:"font-bold text-sm bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent"},Zr={class:"flex justify-between items-center p-3 bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900 dark:to-pink-900 rounded-xl transform hover:scale-[1.02] transition-all duration-300"},$r={class:"font-bold text-sm bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent"},to={key:1,class:"container mx-auto px-4 py-8"},eo={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},ro={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full transform transition-all duration-500 scale-100 custom-fade-in-up"},oo={class:"p-6 text-center"},so={class:"flex flex-col gap-3"};function lo(_,e,n,r,S,I){const L=H("AppHeader"),m=H("router-link");return i(),d("div",It,[V(L),r.story?(i(),d("main",Lt,[t("nav",Ft,[t("ol",Vt,[t("li",null,[V(m,{to:"/",class:"hover:text-purple-800 transition-colors"},{default:M(()=>[...e[15]||(e[15]=[T("الرئيسية",-1)])]),_:1})]),t("li",Dt,[e[17]||(e[17]=t("span",{class:"material-icons text-xs"},"chevron_left",-1)),V(m,{to:"/stories",class:"hover:text-purple-800 transition-colors"},{default:M(()=>[...e[16]||(e[16]=[T("المكتبة",-1)])]),_:1})]),t("li",Mt,[e[18]||(e[18]=t("span",{class:"material-icons text-xs"},"chevron_left",-1)),t("span",Pt,a(r.story.category),1)]),t("li",Et,[e[19]||(e[19]=t("span",{class:"material-icons text-xs"},"chevron_left",-1)),t("span",Nt,a(r.story.title),1)])])]),t("div",Ot,[t("div",Jt,[t("div",Ut,[t("div",zt,[t("div",Ht,[t("div",Bt,[t("div",Gt,[t("span",Kt,a(r.getMediaIcon(r.story.story_type)),1)]),t("div",null,[t("h1",qt,a(r.story.title),1),t("p",Qt,a(r.story.author),1)])]),t("div",Wt,[t("span",Xt,a(r.getMediaTypeArabic(r.story.story_type)),1),t("span",Yt,a(r.story.age_group),1)])])]),t("div",Zt,[r.story.story_type==="pdf"&&r.story.story_file?(i(),d("div",$t,[t("div",te,[e[21]||(e[21]=t("h3",{class:"text-lg font-bold text-purple-800 dark:text-white"},"قارئ الكتاب التفاعلي",-1)),t("div",ee,[t("button",{onClick:e[0]||(e[0]=(...s)=>r.toggleFullscreen&&r.toggleFullscreen(...s)),class:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl hover:from-purple-600 hover:to-pink-600 transition-all duration-300 transform hover:scale-105 text-sm shadow-lg"},[t("span",re,a(r.isFullscreen?"fullscreen_exit":"fullscreen"),1),T(" "+a(r.isFullscreen?"خروج من العرض الكامل":"عرض كامل"),1)]),t("button",{onClick:e[1]||(e[1]=(...s)=>r.downloadFile&&r.downloadFile(...s)),class:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-xl hover:from-green-600 hover:to-emerald-600 transition-all duration-300 transform hover:scale-105 text-sm shadow-lg"},[...e[20]||(e[20]=[t("span",{class:"material-icons text-sm"},"download",-1),T(" تحميل ",-1)])])])]),t("div",oe,[t("div",se,[t("iframe",{src:r.story.story_file,class:"w-full h-full",frameborder:"0"},null,8,le)])])])):r.story.story_type==="video"&&r.story.story_file?(i(),d("div",ae,[e[22]||(e[22]=t("h3",{class:"text-lg font-bold text-purple-800 dark:text-white"},"مشغل الفيديو",-1)),t("div",ne,[t("video",{src:r.story.story_file,controls:"",class:"w-full aspect-video",onPlay:e[2]||(e[2]=(...s)=>r.onVideoPlay&&r.onVideoPlay(...s)),onPause:e[3]||(e[3]=(...s)=>r.onVideoPause&&r.onVideoPause(...s))}," متصفحك لا يدعم تشغيل الفيديو. ",40,ie)])])):r.story.story_type==="audio"&&r.story.story_file?(i(),d("div",de,[e[26]||(e[26]=t("h3",{class:"text-lg font-bold text-purple-800 dark:text-white"},"مشغل الصوت",-1)),t("div",pe,[t("div",ue,[e[23]||(e[23]=t("div",{class:"w-24 h-24 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg transform hover:rotate-12 transition-transform duration-500"},[t("span",{class:"material-icons text-white text-4xl"},"music_note")],-1)),e[24]||(e[24]=t("h4",{class:"text-xl font-bold text-purple-800 dark:text-white mb-2"},"استمع إلى القصة",-1)),e[25]||(e[25]=t("p",{class:"text-purple-600 dark:text-purple-300 mb-6"},"بصوت راوي محترف مع مؤثرات صوتية",-1)),t("audio",{src:r.story.story_file,controls:"",class:"w-full max-w-md mx-auto transform hover:scale-105 transition-all duration-300",onPlay:e[4]||(e[4]=(...s)=>r.onAudioPlay&&r.onAudioPlay(...s))}," متصفحك لا يدعم تشغيل الصوت. ",40,ce)])])])):r.story.story_type==="image"&&r.story.story_file?(i(),d("div",xe,[e[27]||(e[27]=t("h3",{class:"text-lg font-bold text-purple-800 dark:text-white"},"عارض الصور",-1)),t("div",me,[t("div",fe,[t("img",{src:r.story.story_file,alt:r.story.title,class:"max-w-full max-h-96 object-contain rounded-2xl shadow-2xl transform hover:scale-105 transition-transform duration-500",onLoad:e[5]||(e[5]=(...s)=>r.onImageLoad&&r.onImageLoad(...s))},null,40,ve)])])])):(i(),d("div",ge,[...e[28]||(e[28]=[t("div",{class:"w-20 h-20 bg-gradient-to-r from-purple-400 to-pink-400 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg"},[t("span",{class:"material-icons text-white text-4xl"},"error_outline")],-1),t("h3",{class:"text-xl font-bold text-purple-800 dark:text-white mb-2"},"لا يوجد ملف معروض",-1),t("p",{class:"text-purple-600 dark:text-purple-400"},"لم يتم رفع ملف لهذه القصة بعد",-1)])]))])]),t("div",he,[t("div",ke,[t("div",ye,[t("button",{onClick:e[6]||(e[6]=(...s)=>r.toggleLike&&r.toggleLike(...s)),class:P(["flex items-center gap-2 px-4 py-2 rounded-xl transition-all duration-300 transform hover:scale-110",r.isLiked?"bg-gradient-to-r from-red-500 to-pink-500 text-white shadow-lg":"bg-gradient-to-r from-purple-100 to-pink-100 text-purple-600 hover:from-purple-200 hover:to-pink-200 dark:from-purple-800 dark:to-pink-800 dark:text-purple-300 dark:hover:from-purple-700 dark:hover:to-pink-700"])},[t("span",be,a(r.isLiked?"favorite":"favorite_border"),1),t("span",we,a(r.storyStats.likes||0),1)],2),t("button",{onClick:e[7]||(e[7]=(...s)=>r.toggleFavorite&&r.toggleFavorite(...s)),class:P(["flex items-center gap-2 px-4 py-2 rounded-xl transition-all duration-300 transform hover:scale-110",r.isFavorite?"bg-gradient-to-r from-yellow-500 to-orange-500 text-white shadow-lg":"bg-gradient-to-r from-purple-100 to-pink-100 text-purple-600 hover:from-purple-200 hover:to-pink-200 dark:from-purple-800 dark:to-pink-800 dark:text-purple-300 dark:hover:from-purple-700 dark:hover:to-pink-700"])},[t("span",_e,a(r.isFavorite?"bookmark":"bookmark_border"),1),e[29]||(e[29]=t("span",{class:"font-medium"},"المفضلة",-1))],2)]),t("div",Se,[t("button",{onClick:e[8]||(e[8]=(...s)=>r.shareStory&&r.shareStory(...s)),class:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-xl hover:from-blue-600 hover:to-cyan-600 transition-all duration-300 transform hover:scale-105 shadow-lg"},[...e[30]||(e[30]=[t("span",{class:"material-icons text-lg"},"share",-1),t("span",{class:"font-medium"},"مشاركة",-1)])]),t("button",{onClick:e[9]||(e[9]=(...s)=>r.downloadFile&&r.downloadFile(...s)),class:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-xl hover:from-green-600 hover:to-emerald-600 transition-all duration-300 transform hover:scale-105 shadow-lg"},[...e[31]||(e[31]=[t("span",{class:"material-icons text-lg"},"download",-1),t("span",{class:"font-medium"},"تحميل",-1)])])])]),t("div",Ae,[t("div",Ce,[t("div",Te,a(r.storyStats.views||0),1),e[32]||(e[32]=t("div",{class:"text-sm text-purple-600 dark:text-purple-400"},"المشاهدات",-1))]),t("div",Re,[t("div",je,a(r.storyStats.downloads||0),1),e[33]||(e[33]=t("div",{class:"text-sm text-purple-600 dark:text-purple-400"},"التحميلات",-1))]),t("div",Ie,[t("div",Le,a(r.storyStats.shares||0),1),e[34]||(e[34]=t("div",{class:"text-sm text-purple-600 dark:text-purple-400"},"المشاركات",-1))]),t("div",Fe,[t("div",Ve,a(r.formatRating(r.story.rating)),1),e[35]||(e[35]=t("div",{class:"text-sm text-purple-600 dark:text-purple-400"},"التقييم",-1))])])]),t("div",De,[e[37]||(e[37]=t("h3",{class:"text-xl font-bold text-purple-800 dark:text-white mb-4"},"عن القصة",-1)),t("div",Me,[t("p",Pe,a(r.story.summary),1)]),t("div",Ee,[e[36]||(e[36]=t("h4",{class:"text-lg font-bold text-purple-800 dark:text-white mb-3"},"الكلمات المفتاحية",-1)),t("div",Ne,[(i(!0),d(R,null,j(r.storyKeywords,s=>(i(),d("span",{key:s,class:"px-3 py-1 bg-gradient-to-r from-purple-100 to-pink-100 text-purple-700 dark:from-purple-800 dark:to-pink-800 dark:text-purple-300 rounded-full text-sm font-medium hover:from-purple-200 hover:to-pink-200 dark:hover:from-purple-700 dark:hover:to-pink-700 transition-all duration-300 transform hover:scale-105 cursor-pointer shadow-sm"},a(s),1))),128))])])]),t("div",Oe,[t("div",Je,[e[39]||(e[39]=t("h3",{class:"text-xl font-bold text-purple-800 dark:text-white"},"التعليقات والتقييمات",-1)),t("div",Ue,[e[38]||(e[38]=t("span",{class:"material-icons"},"star",-1)),t("span",ze,a(r.formatRating(r.story.rating)),1),t("span",He,"("+a(r.comments.length)+" تعليق)",1)])]),t("div",Be,[e[41]||(e[41]=t("h4",{class:"text-lg font-bold text-purple-800 dark:text-white mb-4"},"أضف تعليقك",-1)),B(t("textarea",{"onUpdate:modelValue":e[10]||(e[10]=s=>r.newComment=s),placeholder:"اكتب تعليقك عن القصة...",rows:"4",class:"w-full border-2 border-purple-200 dark:border-purple-600 rounded-2xl px-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent bg-white dark:bg-gray-800 text-purple-800 dark:text-white resize-none transition-all duration-300"},null,512),[[G,r.newComment]]),t("div",Ge,[t("div",Ke,[e[40]||(e[40]=t("span",{class:"text-sm font-medium text-purple-800 dark:text-white"},"تقييمك:",-1)),t("div",qe,[(i(),d(R,null,j(5,s=>t("span",{key:s,onClick:v=>r.userRating=s,class:P(["cursor-pointer text-2xl transition-all duration-300 hover:scale-125 transform",s<=r.userRating?"text-yellow-400 animate-pulse":"text-purple-300"])}," ★ ",10,Qe)),64))])]),t("button",{onClick:e[11]||(e[11]=(...s)=>r.addComment&&r.addComment(...s)),disabled:!r.newComment.trim(),class:"px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl hover:from-purple-600 hover:to-pink-600 transition-all duration-300 transform hover:scale-105 disabled:opacity-50 font-medium shadow-lg"}," نشر التعليق ",8,We)])]),t("div",Xe,[(i(!0),d(R,null,j(r.comments,s=>{var v;return i(),d("div",{key:s.id,class:"border-2 border-purple-200 dark:border-purple-600 rounded-2xl p-6 hover:border-purple-400 dark:hover:border-purple-500 transition-all duration-500 transform hover:-translate-y-1 hover:shadow-lg"},[t("div",Ye,[t("div",Ze,[t("div",$e,a(s.user.charAt(0)),1),t("div",null,[t("span",tr,a(s.user),1),t("span",er,a(s.date),1)])]),t("div",rr,[(i(),d(R,null,j(5,p=>t("span",{key:p,class:"text-lg"},a(p<=s.rating?"★":"☆"),1)),64))])]),t("p",or,a(s.text),1),t("div",sr,[t("button",{onClick:p=>r.checkAuthThen(()=>r.toggleCommentLike(s.id)),class:"flex items-center gap-1 text-sm hover:text-purple-600 transition-all duration-300 text-purple-600 dark:text-purple-400 transform hover:scale-110"},[e[42]||(e[42]=t("span",{class:"material-icons text-sm"},"thumb_up",-1)),t("span",null,a(s.likes||0),1)],8,lr),t("button",{onClick:p=>r.checkAuthThen(()=>r.toggleReply(s.id)),class:"flex items-center gap-1 text-sm hover:text-purple-600 transition-all duration-300 text-purple-600 dark:text-purple-400 transform hover:scale-110"},[...e[43]||(e[43]=[t("span",{class:"material-icons text-sm"},"reply",-1),t("span",null,"رد",-1)])],8,ar)]),s.showReply?(i(),d("div",nr,[B(t("textarea",{"onUpdate:modelValue":p=>s.replyText=p,placeholder:"اكتب ردك هنا...",rows:"2",class:"w-full border-2 border-purple-200 dark:border-purple-600 rounded-xl px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent bg-white dark:bg-gray-800 text-purple-800 dark:text-white resize-none transition-all duration-300"},null,8,ir),[[G,s.replyText]]),t("div",dr,[t("button",{onClick:p=>r.cancelReply(s.id),class:"px-4 py-2 text-sm text-purple-600 dark:text-purple-400 hover:text-purple-800 dark:hover:text-white transition-all duration-300 transform hover:scale-105"}," إلغاء ",8,pr),t("button",{onClick:p=>r.submitReply(s.id),disabled:!((v=s.replyText)!=null&&v.trim()),class:"px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl hover:from-purple-600 hover:to-pink-600 transition-all duration-300 transform hover:scale-105 disabled:opacity-50 text-sm font-medium shadow-md"}," نشر الرد ",8,ur)])])):E("",!0),s.replies&&s.replies.length>0?(i(),d("div",cr,[(i(!0),d(R,null,j(s.replies,p=>(i(),d("div",{key:p.id,class:"bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900 dark:to-pink-900 rounded-xl p-4 transform hover:scale-[1.02] transition-all duration-300"},[t("div",xr,[t("div",mr,[t("div",fr,a(p.user.charAt(0)),1),t("span",vr,a(p.user),1)]),t("span",gr,a(p.date),1)]),t("p",hr,a(p.text),1)]))),128))])):E("",!0)])}),128))])])]),t("div",kr,[t("div",yr,[e[50]||(e[50]=t("h3",{class:"text-lg font-bold text-purple-800 dark:text-white mb-4"},"تفاصيل القصة",-1)),t("div",br,[t("div",wr,[e[44]||(e[44]=t("span",{class:"text-sm text-purple-600 dark:text-purple-400"},"رقم الوعاء:",-1)),t("span",_r,a(r.story.vessel_number),1)]),t("div",Sr,[e[45]||(e[45]=t("span",{class:"text-sm text-purple-600 dark:text-purple-400"},"المؤلف:",-1)),t("span",Ar,a(r.story.author),1)]),t("div",Cr,[e[46]||(e[46]=t("span",{class:"text-sm text-purple-600 dark:text-purple-400"},"سنة النشر:",-1)),t("span",Tr,a(r.story.publication_year),1)]),t("div",Rr,[e[47]||(e[47]=t("span",{class:"text-sm text-purple-600 dark:text-purple-400"},"الفئة:",-1)),t("span",jr,a(r.story.category),1)]),t("div",Ir,[e[48]||(e[48]=t("span",{class:"text-sm text-purple-600 dark:text-purple-400"},"الحالة:",-1)),t("span",Lr,a(r.getStatusArabic(r.story.status)),1)]),t("div",Fr,[e[49]||(e[49]=t("span",{class:"text-sm text-purple-600 dark:text-purple-400"},"أضيفت في:",-1)),t("span",Vr,a(r.formatDate(r.story.created_at)),1)])])]),t("div",Dr,[e[51]||(e[51]=t("h3",{class:"text-lg font-bold text-purple-800 dark:text-white mb-4"},"قصص مشابهة",-1)),t("div",Mr,[(i(!0),d(R,null,j(r.relatedStories,s=>(i(),d("div",{key:s.id,class:"flex items-center gap-3 p-4 border-2 border-purple-200 dark:border-purple-600 rounded-xl hover:border-purple-400 dark:hover:border-purple-500 transition-all duration-500 transform hover:-translate-y-1 hover:shadow-lg cursor-pointer group",onClick:v=>r.viewRelatedStory(s.id)},[t("div",Er,[t("span",Nr,a(r.getMediaIcon(s.story_type)),1)]),t("div",Or,[t("h4",Jr,a(s.title),1),t("p",Ur,a(s.author),1),t("div",zr,[t("span",Hr,a(s.age_group),1)])])],8,Pr))),128))])]),t("div",Br,[e[56]||(e[56]=t("h3",{class:"text-lg font-bold text-purple-800 dark:text-white mb-4"},"نشاطك",-1)),t("div",Gr,[t("div",Kr,[e[52]||(e[52]=t("span",{class:"text-sm text-purple-600 dark:text-purple-400"},"وقت المشاهدة:",-1)),t("span",qr,a(r.userActivity.watchTime),1)]),t("div",Qr,[e[53]||(e[53]=t("span",{class:"text-sm text-purple-600 dark:text-purple-400"},"القصص المكتملة:",-1)),t("span",Wr,a(r.userActivity.completedStories),1)]),t("div",Xr,[e[54]||(e[54]=t("span",{class:"text-sm text-purple-600 dark:text-purple-400"},"التعليقات:",-1)),t("span",Yr,a(r.userActivity.comments),1)]),t("div",Zr,[e[55]||(e[55]=t("span",{class:"text-sm text-purple-600 dark:text-purple-400"},"التقييمات:",-1)),t("span",$r,a(r.userActivity.ratings),1)])])])])])])):(i(),d("div",to,[...e[57]||(e[57]=[t("div",{class:"text-center py-12"},[t("div",{class:"inline-block animate-spin rounded-full h-16 w-16 border-b-2 border-purple-500 mb-4"}),t("p",{class:"text-purple-600 dark:text-purple-400"},"جاري تحميل القصة...")],-1)])])),V(Rt,{name:"custom-modal"},{default:M(()=>[r.showAuthModal?(i(),d("div",eo,[t("div",ro,[t("div",oo,[e[60]||(e[60]=t("div",{class:"w-16 h-16 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg"},[t("span",{class:"material-icons text-white text-2xl"},"lock")],-1)),e[61]||(e[61]=t("h3",{class:"text-xl font-bold text-purple-800 dark:text-white mb-2"}," يلزم تسجيل الدخول ",-1)),e[62]||(e[62]=t("p",{class:"text-purple-600 dark:text-purple-400 mb-6"}," للاستفادة من جميع الميزات التفاعلية، يرجى تسجيل الدخول إلى حسابك ",-1)),t("div",so,[t("button",{onClick:e[12]||(e[12]=(...s)=>r.redirectToLogin&&r.redirectToLogin(...s)),class:"w-full py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl hover:from-purple-600 hover:to-pink-600 transition-all duration-300 transform hover:scale-105 font-medium flex items-center justify-center gap-2 shadow-lg"},[...e[58]||(e[58]=[t("span",{class:"material-icons text-lg"},"login",-1),T(" تسجيل الدخول ",-1)])]),t("button",{onClick:e[13]||(e[13]=(...s)=>r.redirectToRegister&&r.redirectToRegister(...s)),class:"w-full py-3 border-2 border-purple-500 text-purple-600 dark:text-white dark:border-white rounded-xl hover:bg-gradient-to-r hover:from-purple-500 hover:to-pink-500 hover:text-white transition-all duration-300 transform hover:scale-105 font-medium flex items-center justify-center gap-2"},[...e[59]||(e[59]=[t("span",{class:"material-icons text-lg"},"person_add",-1),T(" إنشاء حساب جديد ",-1)])]),t("button",{onClick:e[14]||(e[14]=(...s)=>r.closeAuthModal&&r.closeAuthModal(...s)),class:"w-full py-3 text-purple-600 dark:text-purple-400 hover:text-purple-800 dark:hover:text-white transition-colors duration-300 font-medium transform hover:scale-105"}," إلغاء ")])])])])):E("",!0)]),_:1})])}const no=_t(jt,[["render",lo],["__scopeId","data-v-80ab19b5"]]);export{no as default};
